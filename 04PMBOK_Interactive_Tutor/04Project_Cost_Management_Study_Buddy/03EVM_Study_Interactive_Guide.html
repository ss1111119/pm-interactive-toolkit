<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å°ˆæ¡ˆæˆæœ¬ç®¡ç† EVM äº’å‹•å­¸ç¿’æŒ‡å— (å®Œæ•´ç‰ˆ)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@300;400;500;700&display=swap');
        body {
            font-family: 'Noto Sans TC', sans-serif;
        }
        .tab-active {
            border-bottom: 2px solid #2563eb;
            color: #2563eb;
            font-weight: 600;
        }
        .status-good { color: #16a34a; font-weight: bold; }
        .status-bad { color: #dc2626; font-weight: bold; }
        .card-shadow { box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06); }
    </style>
</head>
<body class="bg-gray-50 text-gray-800 min-h-screen">

    <!-- Navbar -->
    <nav class="bg-blue-600 text-white p-4 shadow-lg">
        <div class="container mx-auto flex justify-between items-center">
            <h1 class="text-xl md:text-2xl font-bold flex items-center gap-2">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 7h6m0 3.666V14m-3 3h3m-3-6h6m-9 0H6m6-3H9m-3 6H5a2 2 0 00-2 2v1a2 2 0 002 2h14a2 2 0 002-2v-1a2 2 0 00-2-2h-1M9 7V5a2 2 0 012-2h2a2 2 0 012 2v2" />
                </svg>
                å°ˆæ¡ˆæˆæœ¬ç®¡ç† EVM æ•‘ç”Ÿåœˆ
            </h1>
            <span class="text-xs md:text-sm bg-blue-700 px-3 py-1 rounded-full">å®Œæ•´å‚™è€ƒç‰ˆ</span>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="container mx-auto p-4 md:p-6 max-w-5xl">
        
        <!-- Tabs -->
        <div class="flex border-b border-gray-200 mb-6 overflow-x-auto">
            <button onclick="switchTab('concept')" id="tab-concept" class="tab-active px-6 py-3 focus:outline-none whitespace-nowrap">1. æ ¸å¿ƒè§€å¿µ & é æ¸¬</button>
            <button onclick="switchTab('calculator')" id="tab-calculator" class="px-6 py-3 text-gray-500 hover:text-blue-500 focus:outline-none whitespace-nowrap">2. äº’å‹•è¨ˆç®—æ©Ÿ (å«é æ¸¬)</button>
            <button onclick="switchTab('quiz')" id="tab-quiz" class="px-6 py-3 text-gray-500 hover:text-blue-500 focus:outline-none whitespace-nowrap">3. æ¨¡æ“¬è€ƒé¡Œ</button>
        </div>

        <!-- Section 1: Concepts -->
        <div id="content-concept" class="space-y-6">
            <!-- Part 1: Basics -->
            <div class="bg-white p-6 rounded-lg card-shadow border-l-4 border-blue-500">
                <h2 class="text-2xl font-bold mb-4 text-gray-800">åŸºç¤ç¯‡ï¼šç”¨ã€Œåˆ·æ²¹æ¼†ã€ç§’æ‡‚ EVM</h2>
                <p class="mb-4 text-lg">å‡è¨­ä½ è¦ç²‰åˆ·æˆ¿é–“ï¼Œè¨ˆç•«æ˜¯ <span class="font-bold text-blue-600">4å¤©</span> åˆ·å®Œ <span class="font-bold text-blue-600">4é¢ç‰†</span>ï¼Œç¸½é ç®— <span class="font-bold text-blue-600">$4,000</span> (ä¸€é¢ç‰† $1,000)ã€‚ä»Šå¤©æ˜¯ç¬¬ 2 å¤©æ™šä¸Š...</p>
                
                <div class="grid md:grid-cols-3 gap-6 mt-6">
                    <!-- PV -->
                    <div class="bg-gray-50 p-4 rounded-lg border border-gray-200">
                        <div class="flex items-center gap-2 mb-2">
                            <span class="bg-gray-200 text-gray-700 font-bold px-2 py-1 rounded">PV</span>
                            <h3 class="font-bold text-lg">è¨ˆç•«åƒ¹å€¼</h3>
                        </div>
                        <p class="text-sm text-gray-600 mb-2">Planned Value</p>
                        <p class="font-medium text-sm">ã€ŒåŸæœ¬è¨ˆç•«è©²åšå¤šå°‘ï¼Ÿã€</p>
                        <p class="mt-1 text-sm text-gray-500">ç¬¬2å¤©æ‡‰åˆ·å®Œ 2 é¢ç‰† ($2,000)ã€‚</p>
                    </div>

                    <!-- EV -->
                    <div class="bg-yellow-50 p-4 rounded-lg border border-yellow-200 ring-2 ring-yellow-400">
                        <div class="flex items-center gap-2 mb-2">
                            <span class="bg-yellow-400 text-yellow-900 font-bold px-2 py-1 rounded">EV</span>
                            <h3 class="font-bold text-lg">å¯¦ç²å€¼ (ä¸»è§’)</h3>
                        </div>
                        <p class="text-sm text-gray-600 mb-2">Earned Value</p>
                        <p class="font-medium text-sm">ã€Œå¯¦éš›å®Œæˆäº†å¤šå°‘åƒ¹å€¼ï¼Ÿã€</p>
                        <p class="mt-1 text-sm text-gray-500">å¯¦éš›åªåˆ·å®Œ 1 é¢ç‰† ($1,000)ã€‚</p>
                    </div>

                    <!-- AC -->
                    <div class="bg-gray-50 p-4 rounded-lg border border-gray-200">
                        <div class="flex items-center gap-2 mb-2">
                            <span class="bg-gray-200 text-gray-700 font-bold px-2 py-1 rounded">AC</span>
                            <h3 class="font-bold text-lg">å¯¦éš›æˆæœ¬</h3>
                        </div>
                        <p class="text-sm text-gray-600 mb-2">Actual Cost</p>
                        <p class="font-medium text-sm">ã€Œå¯¦éš›ä»˜å‡ºå»å¤šå°‘éŒ¢ï¼Ÿã€</p>
                        <p class="mt-1 text-sm text-gray-500">æ²¹æ¼†æ¼²åƒ¹èŠ±äº† $1,500ã€‚</p>
                    </div>
                </div>
            </div>

            <!-- Part 2: Forecasting (New) -->
            <div class="bg-white p-6 rounded-lg card-shadow border-l-4 border-purple-500">
                <h2 class="text-2xl font-bold mb-4 text-gray-800">é€²éšç¯‡ï¼šæ°´æ™¶çƒé æ¸¬ (Forecasting)</h2>
                <p class="mb-4">EVM ä¸åªèƒ½çœ‹ç¾åœ¨ï¼Œé‚„èƒ½ã€Œç®—å‘½ã€ã€‚æ—¢ç„¶ç¾åœ¨æ•ˆç‡æ˜¯é€™æ¨£ (CPI)ï¼Œé‚£å°‡ä¾†æœƒå¦‚ä½•ï¼Ÿ</p>
                <div class="grid md:grid-cols-2 gap-6">
                    <div>
                        <h3 class="font-bold text-lg text-purple-700 mb-2">é—œéµåè©</h3>
                        <ul class="space-y-3">
                            <li class="bg-purple-50 p-2 rounded">
                                <strong>BAC (å®Œå·¥é ç®—)ï¼š</strong> å°ˆæ¡ˆä¸€é–‹å§‹æ ¸å®šçš„ç¸½é ç®— ($4,000)ã€‚
                            </li>
                            <li class="bg-purple-50 p-2 rounded">
                                <strong>EAC (å®Œå·¥ä¼°è¨ˆ)ï¼š</strong> æŒ‰ç…§ç¾åœ¨çš„æ•ˆç‡ï¼Œåšå®Œè¦èŠ±å¤šå°‘éŒ¢ï¼Ÿ<br>
                                <code class="text-sm bg-gray-200 px-1 rounded">å…¬å¼ï¼šEAC = BAC / CPI</code>
                            </li>
                            <li class="bg-purple-50 p-2 rounded">
                                <strong>VAC (å®Œå·¥è®Šç•°)ï¼š</strong> åšå®Œæ™‚æœƒè¶…æ”¯å¤šå°‘ï¼Ÿ<br>
                                <code class="text-sm bg-gray-200 px-1 rounded">å…¬å¼ï¼šVAC = BAC - EAC</code>
                            </li>
                        </ul>
                    </div>
                    <div class="bg-gray-50 p-4 rounded text-sm">
                        <h4 class="font-bold mb-2">å¯¦ä¾‹æ¼”ç·´ï¼š</h4>
                        <p class="mb-2">å¦‚æœä½ çš„æ²¹æ¼†å·¥æ•ˆç‡å¾ˆå·® (CPI = 0.5)ï¼ŒåŸæœ¬é ç®— $4,000 çš„å·¥ç¨‹...</p>
                        <p class="mb-2">ğŸ‘‰ <strong>å®Œå·¥ä¼°è¨ˆ (EAC)</strong> æœƒè®Šæˆ $8,000 (ä½ éœ€è¦é›™å€é ç®—)ã€‚</p>
                        <p>ğŸ‘‰ <strong>å®Œå·¥è®Šç•° (VAC)</strong> å°±æ˜¯ -$4,000 (ä½ æœƒè¶…æ”¯ 4000)ã€‚</p>
                    </div>
                </div>
            </div>

            <!-- Part 3: Management Context (New) -->
            <div class="bg-white p-6 rounded-lg card-shadow">
                <h2 class="text-xl font-bold mb-4 text-gray-800">ç®¡ç†æ¶æ§‹èˆ‡ WBS æ•´åˆ</h2>
                <div class="grid md:grid-cols-2 gap-6 text-sm">
                    <div>
                        <h3 class="font-bold mb-2">æ§åˆ¶å¸³æˆ¶ (Control Accounts)</h3>
                        <p class="text-gray-600 mb-2">EVM ä¸æ˜¯å°ã€Œæ•´å€‹å¤§å°ˆæ¡ˆã€ç®—ä¸€å€‹æ•¸å­—å°±å¥½ï¼Œé€šå¸¸æœƒç´°åˆ†ã€‚</p>
                        <p class="text-gray-600">åœ¨ WBS (å·¥ä½œåˆ†è§£çµæ§‹) ä¸­ï¼Œæˆ‘å€‘æœƒè¨­å®šç‰¹å®šçš„ç¯€é»ç‚ºã€Œæ§åˆ¶å¸³æˆ¶ã€ã€‚é€™æ˜¯è¨ˆç®— EVM çš„å–®ä½ï¼Œå¯ä»¥ç²¾ç¢ºæŠ“å‡ºæ˜¯ã€Œå“ªä¸€å€‹éƒ¨åˆ†ã€æˆæœ¬å¤±æ§ã€‚</p>
                    </div>
                    <div>
                        <h3 class="font-bold mb-2">ç®¡åˆ¶æˆæœ¬çš„æ ¸å¿ƒç›®çš„</h3>
                        <p class="text-gray-600 mb-2">ä¸åªæ˜¯ã€Œè¨˜å¸³ã€ï¼Œè€Œæ˜¯ã€Œç®¡ç†è®Šæ›´ã€ã€‚</p>
                        <ul class="list-disc list-inside text-gray-600">
                            <li>æ‰¾å‡ºå¯¦éš›èˆ‡è¨ˆç•«çš„å·®ç•° (è®Šç•°åˆ†æ)ã€‚</li>
                            <li>æ¡å–<strong>çŸ¯æ­£æªæ–½</strong>ã€‚</li>
                            <li>ç¢ºä¿æ‰€æœ‰åŸºæº–çš„è®Šæ›´éƒ½ç¶“éæ ¸å‡†ã€‚</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>

        <!-- Section 2: Calculator -->
        <div id="content-calculator" class="hidden space-y-6">
            <div class="grid md:grid-cols-12 gap-6">
                <!-- Inputs -->
                <div class="md:col-span-4 bg-white p-6 rounded-lg card-shadow h-fit">
                    <h2 class="text-xl font-bold mb-4 flex items-center gap-2">
                        <span>ğŸ§®</span> å°ˆæ¡ˆæ•¸æ“šè¼¸å…¥
                    </h2>
                    <div class="space-y-4">
                        <div class="pb-4 border-b">
                            <label class="block text-sm font-medium text-gray-700 mb-1">BAC (ç¸½é ç®—) <span class="text-xs text-gray-400">ç¸½å…±å¤šå°‘éŒ¢?</span></label>
                            <input type="number" id="input-bac" value="4000" class="w-full p-2 border border-purple-300 rounded focus:ring-2 focus:ring-purple-500" oninput="calculateEVM()">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">PV (è¨ˆç•«åƒ¹å€¼)</label>
                            <input type="number" id="input-pv" value="2000" class="w-full p-2 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500" oninput="calculateEVM()">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">EV (å¯¦ç²å€¼) <span class="text-xs text-red-500 font-bold">*é—œéµ</span></label>
                            <input type="number" id="input-ev" value="1000" class="w-full p-2 border border-gray-300 rounded focus:ring-2 focus:ring-yellow-500 bg-yellow-50" oninput="calculateEVM()">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">AC (å¯¦éš›æˆæœ¬)</label>
                            <input type="number" id="input-ac" value="1500" class="w-full p-2 border border-gray-300 rounded focus:ring-2 focus:ring-red-500" oninput="calculateEVM()">
                        </div>
                    </div>
                </div>

                <!-- Outputs -->
                <div class="md:col-span-8 space-y-6">
                    <!-- Current Status -->
                    <div class="bg-white p-6 rounded-lg card-shadow">
                        <h2 class="text-xl font-bold mb-4 border-b pb-2">ğŸ“Š ç›®å‰ç‹€æ…‹ (Current Status)</h2>
                        <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
                            <div class="p-3 bg-gray-50 rounded text-center">
                                <p class="text-xs text-gray-500">CPI (æˆæœ¬æ•ˆç‡)</p>
                                <p id="res-cpi" class="text-2xl font-bold">--</p>
                                <p id="desc-cpi" class="text-[10px] font-medium">--</p>
                            </div>
                            <div class="p-3 bg-gray-50 rounded text-center">
                                <p class="text-xs text-gray-500">SPI (é€²åº¦æ•ˆç‡)</p>
                                <p id="res-spi" class="text-2xl font-bold">--</p>
                                <p id="desc-spi" class="text-[10px] font-medium">--</p>
                            </div>
                            <div class="p-3 bg-gray-50 rounded text-center">
                                <p class="text-xs text-gray-500">CV (æˆæœ¬å·®ç•°)</p>
                                <p id="res-cv" class="text-lg font-bold">--</p>
                            </div>
                            <div class="p-3 bg-gray-50 rounded text-center">
                                <p class="text-xs text-gray-500">SV (é€²åº¦å·®ç•°)</p>
                                <p id="res-sv" class="text-lg font-bold">--</p>
                            </div>
                        </div>
                        <div class="mt-4 text-sm bg-blue-50 p-3 rounded text-blue-800">
                            <strong>è¨ºæ–·ï¼š</strong> <span id="diagnosis-text">--</span>
                        </div>
                    </div>

                    <!-- Future Forecast -->
                    <div class="bg-white p-6 rounded-lg card-shadow border border-purple-100">
                        <h2 class="text-xl font-bold mb-4 border-b pb-2 flex items-center gap-2">
                            ğŸ”® æœªä¾†é æ¸¬ (Forecasting)
                            <span class="text-xs font-normal text-gray-500 bg-gray-100 px-2 py-1 rounded">åŸºæ–¼ç›®å‰ CPI é ä¼°</span>
                        </h2>
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                            <div class="p-4 bg-purple-50 rounded border border-purple-100">
                                <p class="text-xs text-gray-600 mb-1">EAC (é ä¼°å®Œå·¥ç¸½èŠ±è²»)</p>
                                <p id="res-eac" class="text-2xl font-bold text-purple-700">--</p>
                                <p class="text-[10px] text-gray-500">åŸæœ¬é ç®—: <span id="disp-bac">--</span></p>
                            </div>
                            <div class="p-4 bg-purple-50 rounded border border-purple-100">
                                <p class="text-xs text-gray-600 mb-1">VAC (å®Œå·¥æ™‚æœƒè¶…æ”¯å¤šå°‘)</p>
                                <p id="res-vac" class="text-xl font-bold">--</p>
                                <p class="text-[10px] text-gray-500">æ­£æ•¸=çœéŒ¢, è² æ•¸=è¶…æ”¯</p>
                            </div>
                            <div class="p-4 bg-purple-50 rounded border border-purple-100">
                                <p class="text-xs text-gray-600 mb-1">ETC (é‚„éœ€æŠ•å…¥å¤šå°‘éŒ¢)</p>
                                <p id="res-etc" class="text-xl font-bold text-gray-700">--</p>
                                <p class="text-[10px] text-gray-500">EAC - AC</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Chart -->
            <div class="bg-white p-6 rounded-lg card-shadow h-64">
                <canvas id="evmChart"></canvas>
            </div>
        </div>

        <!-- Section 3: Quiz -->
        <div id="content-quiz" class="hidden space-y-6">
            <div class="bg-white p-6 rounded-lg card-shadow">
                <h2 class="text-2xl font-bold mb-6">æ¨¡æ“¬å°è€ƒ</h2>
                
                <!-- Question 1 -->
                <div class="mb-8 border-b pb-6">
                    <p class="font-bold text-lg mb-3">Q1. å°ˆæ¡ˆç¶“ç†è¨ˆç®—å‡º CPI = 0.8ã€‚è‹¥æ­¤ç¸¾æ•ˆæŒçºŒä¸‹å»ï¼Œå°æ–¼ã€Œå®Œå·¥ä¼°è¨ˆ (EAC)ã€çš„å½±éŸ¿ç‚ºä½•ï¼Ÿ</p>
                    <div class="space-y-2">
                        <button onclick="checkAnswer(this, false, 'EAC æœƒè®Šå°ä»£è¡¨çœéŒ¢ï¼Œä½† CPI < 1 æ˜¯è¶…æ”¯ã€‚')" class="w-full text-left p-3 border rounded hover:bg-gray-50">A. EAC æœƒå°æ–¼åŸæœ¬çš„é ç®— (BAC)</button>
                        <button onclick="checkAnswer(this, true, 'æ­£ç¢ºï¼æ•ˆç‡å·® (CPI < 1) ä»£è¡¨åšå®ŒåŒæ¨£çš„äº‹è¦èŠ±æ›´å¤šéŒ¢ï¼Œæ‰€ä»¥ EAC æœƒå¤§æ–¼ BACã€‚')" class="w-full text-left p-3 border rounded hover:bg-gray-50">B. EAC æœƒå¤§æ–¼åŸæœ¬çš„é ç®— (BAC)</button>
                        <button onclick="checkAnswer(this, false, 'EAC = BAC åªæœ‰åœ¨ CPI = 1 æ™‚æ‰æœƒç™¼ç”Ÿã€‚')" class="w-full text-left p-3 border rounded hover:bg-gray-50">C. EAC æœƒç­‰æ–¼åŸæœ¬çš„é ç®— (BAC)</button>
                    </div>
                    <div class="mt-2 p-3 rounded hidden feedback-box"></div>
                </div>

                <!-- Question 2 -->
                <div class="mb-8 border-b pb-6">
                    <p class="font-bold text-lg mb-3">Q2. ç‚ºäº†æ›´ç´°ç·»åœ°ç®¡ç†æˆæœ¬ï¼Œæˆ‘å€‘é€šå¸¸åœ¨ WBS çš„å“ªå€‹å±¤ç´šè¨­å®š EVM ç›£æ¸¬é»ï¼Ÿ</p>
                    <div class="space-y-2">
                        <button onclick="checkAnswer(this, false, 'é‡Œç¨‹ç¢‘é€šå¸¸åªä»£è¡¨æ™‚é–“é»ï¼Œä¸ä¸€å®šåŒ…å«å…·é«”æˆæœ¬ç´°ç¯€ã€‚')" class="w-full text-left p-3 border rounded hover:bg-gray-50">A. é‡Œç¨‹ç¢‘ (Milestone)</button>
                        <button onclick="checkAnswer(this, true, 'æ­£ç¢ºï¼æ§åˆ¶å¸³æˆ¶æ˜¯ WBS ä¸­ç”¨ä¾†æ•´åˆç¯„ç–‡ã€é ç®—ã€å¯¦éš›æˆæœ¬çš„ç®¡ç†æ§åˆ¶é»ã€‚')" class="w-full text-left p-3 border rounded hover:bg-gray-50">B. æ§åˆ¶å¸³æˆ¶ (Control Account)</button>
                        <button onclick="checkAnswer(this, false, 'å°ˆæ¡ˆç« ç¨‹å¤ªé«˜å±¤ç´šäº†ã€‚')" class="w-full text-left p-3 border rounded hover:bg-gray-50">C. å°ˆæ¡ˆç« ç¨‹ (Project Charter)</button>
                    </div>
                    <div class="mt-2 p-3 rounded hidden feedback-box"></div>
                </div>

                <!-- Question 3 -->
                <div>
                    <p class="font-bold text-lg mb-3">Q3. å°ˆæ¡ˆç¶“ç†ç™¼ç¾ CV < 0 ä¸” SV < 0ï¼Œé€™è¡¨ç¤ºï¼Ÿ</p>
                    <div class="space-y-2">
                        <button onclick="checkAnswer(this, true, 'æ­£ç¢ºï¼å…©è€…éƒ½å°æ–¼ 0ï¼Œä»£è¡¨æ—¢è¶…æ”¯åˆè½å¾Œï¼Œæ˜¯æœ€ç³Ÿçš„æƒ…æ³ã€‚')" class="w-full text-left p-3 border rounded hover:bg-gray-50">A. é€²åº¦è½å¾Œï¼Œä¸”æˆæœ¬è¶…æ”¯</button>
                        <button onclick="checkAnswer(this, false, 'CV < 0 æ˜¯è¶…æ”¯ã€‚')" class="w-full text-left p-3 border rounded hover:bg-gray-50">B. é€²åº¦è½å¾Œï¼Œä½†æˆæœ¬ç¯€ç´„</button>
                    </div>
                    <div class="mt-2 p-3 rounded hidden feedback-box"></div>
                </div>

            </div>
        </div>

    </main>

    <footer class="bg-gray-800 text-gray-400 py-6 mt-12 text-center">
        <p>Created for PMP Study â€¢ EVM Guide (Full Version)</p>
    </footer>

    <script>
        // Tab Switching Logic
        function switchTab(tabId) {
            // Hide all contents
            document.getElementById('content-concept').classList.add('hidden');
            document.getElementById('content-calculator').classList.add('hidden');
            document.getElementById('content-quiz').classList.add('hidden');
            
            // Reset Tab Styles
            ['concept', 'calculator', 'quiz'].forEach(t => {
                document.getElementById('tab-' + t).className = "px-6 py-3 text-gray-500 hover:text-blue-500 focus:outline-none whitespace-nowrap";
            });

            // Activate selected tab
            document.getElementById('content-' + tabId).classList.remove('hidden');
            document.getElementById('tab-' + tabId).className = "tab-active px-6 py-3 focus:outline-none whitespace-nowrap";
            
            if(tabId === 'calculator' && myChart) myChart.resize();
        }

        // Calculator Logic
        let myChart = null;

        function calculateEVM() {
            const bac = parseFloat(document.getElementById('input-bac').value) || 0;
            const pv = parseFloat(document.getElementById('input-pv').value) || 0;
            const ev = parseFloat(document.getElementById('input-ev').value) || 0;
            const ac = parseFloat(document.getElementById('input-ac').value) || 0;

            // 1. Basic EVM
            const cv = ev - ac;
            const sv = ev - pv;
            const cpi = ac === 0 ? 0 : (ev / ac);
            const spi = pv === 0 ? 0 : (ev / pv);

            // 2. Forecasting (EAC = BAC / CPI)
            let eac = 0;
            if (cpi === 0) {
                 eac = bac; // Avoid infinity, assume plan if no data
            } else {
                 eac = bac / cpi;
            }
            
            const vac = bac - eac;
            const etc = eac - ac; // Estimate to Complete

            // Update UI - Basic
            document.getElementById('res-cpi').innerText = cpi.toFixed(2);
            document.getElementById('res-spi').innerText = spi.toFixed(2);
            document.getElementById('res-cv').innerText = Math.round(cv);
            document.getElementById('res-sv').innerText = Math.round(sv);

            // Update UI - Forecast
            document.getElementById('disp-bac').innerText = bac;
            document.getElementById('res-eac').innerText = Math.round(eac);
            document.getElementById('res-vac').innerText = Math.round(vac);
            document.getElementById('res-etc').innerText = Math.round(etc);

            // Coloring
            updateStatus('cpi', cpi, 1);
            updateStatus('spi', spi, 1);
            updateStatusVal('cv', cv);
            updateStatusVal('sv', sv);
            
            // Forecast coloring
            const vacEl = document.getElementById('res-vac');
            if(vac < 0) vacEl.className = "text-xl font-bold text-red-600";
            else vacEl.className = "text-xl font-bold text-green-600";

            // Diagnosis Text
            let diag = "";
            if (cpi < 1) diag += "ç›®å‰æ¯èŠ± $1 åªèƒ½å›å ± $" + cpi.toFixed(2) + " çš„åƒ¹å€¼ã€‚";
            else diag += "æˆæœ¬æ§åˆ¶è‰¯å¥½ã€‚";
            
            if (vac < 0) diag += " è‹¥ä¸æ”¹å–„ï¼Œå°ˆæ¡ˆçµæŸæ™‚é è¨ˆæœƒè¶…æ”¯ $" + Math.abs(Math.round(vac)) + "ã€‚";
            else diag += " é è¨ˆçµæ¡ˆæ™‚å¯ç¯€çœ $" + Math.round(vac) + "ã€‚";

            document.getElementById('diagnosis-text').innerText = diag;

            // Chart
            updateChart(bac, pv, ev, ac, eac);
        }

        function updateStatus(id, val, benchmark) {
            const el = document.getElementById('res-' + id);
            const desc = document.getElementById('desc-' + id);
            if (val < benchmark) {
                el.className = "text-2xl font-bold text-red-600";
                if(id==='cpi') desc.innerText = "æˆæœ¬è¶…æ”¯";
                if(id==='spi') desc.innerText = "é€²åº¦è½å¾Œ";
                desc.className = "text-[10px] font-medium text-red-600";
            } else {
                el.className = "text-2xl font-bold text-green-600";
                if(id==='cpi') desc.innerText = "æˆæœ¬ç¯€ç´„";
                if(id==='spi') desc.innerText = "é€²åº¦è¶…å‰";
                desc.className = "text-[10px] font-medium text-green-600";
            }
        }

        function updateStatusVal(id, val) {
            const el = document.getElementById('res-' + id);
            el.className = val < 0 ? "text-lg font-bold text-red-600" : "text-lg font-bold text-green-600";
        }

        function updateChart(bac, pv, ev, ac, eac) {
            const ctx = document.getElementById('evmChart').getContext('2d');
            if (myChart) {
                myChart.data.datasets[0].data = [bac, pv, ev, ac, eac];
                myChart.update();
            } else {
                myChart = new Chart(ctx, {
                    type: 'bar',
                    data: {
                        labels: ['BAC (ç¸½é ç®—)', 'PV (è¨ˆç•«)', 'EV (å¯¦ç²)', 'AC (å¯¦èŠ±)', 'EAC (é ä¼°å®Œå·¥)'],
                        datasets: [{
                            label: 'é‡‘é¡ ($)',
                            data: [bac, pv, ev, ac, eac],
                            backgroundColor: [
                                'rgba(107, 114, 128, 0.5)', // BAC - Gray
                                'rgba(59, 130, 246, 0.5)',  // PV - Blue
                                'rgba(245, 158, 11, 0.8)',  // EV - Yellow (Strong)
                                'rgba(239, 68, 68, 0.5)',   // AC - Red
                                'rgba(147, 51, 234, 0.5)'   // EAC - Purple
                            ],
                            borderColor: [
                                'rgba(107, 114, 128, 1)',
                                'rgba(59, 130, 246, 1)',
                                'rgba(245, 158, 11, 1)',
                                'rgba(239, 68, 68, 1)',
                                'rgba(147, 51, 234, 1)'
                            ],
                            borderWidth: 1
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        scales: { y: { beginAtZero: true } },
                        plugins: { legend: { display: false } }
                    }
                });
            }
        }

        // Quiz
        function checkAnswer(btn, isCorrect, feedback) {
            const parent = btn.parentElement;
            const feedbackBox = parent.nextElementSibling;
            const buttons = parent.getElementsByTagName('button');
            for(let b of buttons) {
                b.classList.remove('bg-green-100', 'border-green-500', 'bg-red-100', 'border-red-500');
                b.disabled = true;
            }
            if(isCorrect) {
                btn.classList.add('bg-green-100', 'border-green-500');
                feedbackBox.className = "mt-2 p-3 rounded bg-green-50 text-green-800 border border-green-200";
                feedbackBox.innerHTML = "âœ… " + feedback;
            } else {
                btn.classList.add('bg-red-100', 'border-red-500');
                feedbackBox.className = "mt-2 p-3 rounded bg-red-50 text-red-800 border border-red-200";
                feedbackBox.innerHTML = "âŒ " + feedback;
            }
            feedbackBox.classList.remove('hidden');
        }

        window.onload = function() { calculateEVM(); }
    </script>
</body>
</html>