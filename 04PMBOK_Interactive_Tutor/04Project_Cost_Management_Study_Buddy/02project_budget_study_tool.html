<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å°ˆæ¡ˆæˆæœ¬ç®¡ç†ï¼šåˆ¶å®šé ç®—å­¸ç¿’å™¨</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body { font-family: 'Segoe UI', 'Microsoft JhengHei', sans-serif; }
        .tab-active { border-bottom: 2px solid #2563eb; color: #2563eb; font-weight: bold; }
        .fade-in { animation: fadeIn 0.5s ease-in; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        .card-hover:hover { transform: translateY(-2px); transition: all 0.2s; box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06); }
    </style>
</head>
<body class="bg-slate-50 text-slate-800 min-h-screen">

    <!-- Navbar -->
    <nav class="bg-blue-600 text-white p-4 shadow-lg sticky top-0 z-50">
        <div class="max-w-4xl mx-auto flex justify-between items-center">
            <h1 class="text-xl font-bold flex items-center gap-2">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 7h6m0 3.659c0 3.074-1.8 6-6 6a1 1 0 01-1-1v-2a2 2 0 012-2h1.172a2 2 0 00.707-.293l.293-.293a1 1 0 00-.293-.707L13 11m-1-4v1m0-5a9 9 0 110 18 9 9 0 010-18z" />
                </svg>
                å°ç™½ä¹Ÿèƒ½æ‡‚çš„ PMPï¼šåˆ¶å®šé ç®—
            </h1>
            <div class="text-sm bg-blue-700 px-3 py-1 rounded-full">è€ƒè©¦æº–å‚™æ¨¡å¼</div>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="max-w-4xl mx-auto p-4 mt-4">
        
        <!-- Tabs -->
        <div class="flex border-b border-gray-200 mb-6 bg-white rounded-t-lg overflow-hidden shadow-sm">
            <button onclick="switchTab('concept')" id="tab-concept" class="flex-1 py-4 text-center hover:bg-gray-50 transition tab-active">
                ğŸ“š è§€å¿µåœ–è§£
            </button>
            <button onclick="switchTab('visual')" id="tab-visual" class="flex-1 py-4 text-center hover:bg-gray-50 transition">
                ğŸ“ˆ S æ›²ç·šæ¨¡æ“¬
            </button>
            <button onclick="switchTab('quiz')" id="tab-quiz" class="flex-1 py-4 text-center hover:bg-gray-50 transition">
                ğŸ“ æ¨¡æ“¬æ¸¬é©—
            </button>
        </div>

        <!-- Content Area -->
        <div id="content-area" class="bg-white rounded-b-lg shadow-md p-6 min-h-[500px]">
            
            <!-- 1. Concept Section -->
            <div id="view-concept" class="fade-in space-y-6">
                <div class="bg-blue-50 border-l-4 border-blue-500 p-4 mb-4">
                    <p class="font-bold text-blue-700">æ ¸å¿ƒé‚è¼¯ï¼šå±¤å±¤å †ç–Š</p>
                    <p class="text-sm text-blue-600">é ç®—ä¸æ˜¯æ†‘ç©ºçŒœæ¸¬ï¼Œè€Œæ˜¯åƒè“‹ç©æœ¨ä¸€æ¨£ç”±ä¸‹è€Œä¸Šå †ç–Šèµ·ä¾†çš„ã€‚</p>
                </div>

                <div class="space-y-6">
                    <!-- Hierarchy Visual -->
                    <div class="relative p-6 border-2 border-dashed border-gray-300 rounded-xl bg-gray-50">
                        <h3 class="text-center font-bold text-lg mb-6 text-gray-700">ğŸ’° å°ˆæ¡ˆé ç®—å±¤ç´šåœ– (å¿…è€ƒ!)</h3>
                        
                        <!-- Level 4 -->
                        <div class="mx-auto w-3/4 bg-red-100 border-2 border-red-400 p-4 rounded-lg text-center relative mb-2 card-hover cursor-help group">
                            <h4 class="font-bold text-red-800">å°ˆæ¡ˆé ç®— (Project Budget)</h4>
                            <p class="text-xs text-red-600">åŒ…å«æ‰€æœ‰éŒ¢ (åŸºæº– + ç®¡ç†å„²å‚™é‡‘)</p>
                            <!-- Tooltip -->
                            <div class="hidden group-hover:block absolute z-10 w-64 bg-gray-800 text-white text-xs rounded p-2 -top-16 left-1/2 transform -translate-x-1/2">
                                é‡å°ã€ŒæœªçŸ¥çš„ä¸ç¢ºå®šæ€§ã€(Unknown Unknowns)ï¼Œå‹•ç”¨éœ€é«˜å±¤æ ¸å‡†ã€‚
                            </div>
                        </div>

                        <!-- Connector -->
                        <div class="flex justify-center my-1"><span class="text-2xl text-gray-400">â¬†ï¸</span></div>

                        <!-- Level 3 -->
                        <div class="mx-auto w-2/3 bg-green-100 border-2 border-green-500 p-4 rounded-lg text-center relative mb-2 card-hover cursor-help group shadow-lg">
                            <h4 class="font-bold text-green-800 text-xl">æˆæœ¬åŸºæº– (Cost Baseline)</h4>
                            <p class="text-xs text-green-600">S æ›²ç·šå°±æ˜¯ç•«é€™æ¢ç·šï¼åŒ…å«æ‡‰è®Šå„²å‚™é‡‘ã€‚</p>
                            <div class="absolute -right-32 top-4 bg-yellow-100 text-yellow-800 text-xs px-2 py-1 rounded border border-yellow-400 transform rotate-12 shadow-sm">
                                â­ ç¸¾æ•ˆæ¸¬é‡æ¨™æº–
                            </div>
                             <div class="hidden group-hover:block absolute z-10 w-64 bg-gray-800 text-white text-xs rounded p-2 top-1/2 -right-64 transform -translate-y-1/2">
                                é€™æ˜¯å°ˆæ¡ˆç¶“ç†çš„ã€Œè–ç¶“ã€ï¼Œä»»ä½•è®Šæ›´éƒ½è¦èµ°ã€Œè®Šæ›´æ§åˆ¶æµç¨‹ã€ã€‚åŒ…å«å·²çŸ¥é¢¨éšªçš„æ‡‰è®Šé‡‘ã€‚
                            </div>
                        </div>

                        <!-- Connector -->
                        <div class="flex justify-center my-1"><span class="text-2xl text-gray-400">â¬†ï¸</span></div>

                        <!-- Level 2 -->
                        <div class="mx-auto w-1/2 bg-blue-100 border border-blue-300 p-2 rounded-lg text-center mb-2">
                            <h4 class="font-semibold text-blue-800">å·¥ä½œåŒ…ä¼°ç®— (Work Packages)</h4>
                        </div>

                        <!-- Connector -->
                        <div class="flex justify-center my-1"><span class="text-2xl text-gray-400">â¬†ï¸</span></div>

                        <!-- Level 1 -->
                        <div class="flex justify-center gap-2">
                            <div class="bg-gray-100 border border-gray-300 p-2 rounded text-xs">æ´»å‹• A æˆæœ¬</div>
                            <div class="bg-gray-100 border border-gray-300 p-2 rounded text-xs">æ´»å‹• B æˆæœ¬</div>
                            <div class="bg-gray-100 border border-gray-300 p-2 rounded text-xs">æ´»å‹• C æˆæœ¬</div>
                        </div>
                    </div>

                    <!-- Additional Knowledge Points (New Section) -->
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mt-6">
                        <div class="bg-yellow-50 p-4 rounded-lg border border-yellow-200">
                            <h4 class="font-bold text-yellow-800 mb-2">ğŸ› ï¸ å…¶ä»–é—œéµå·¥å…·</h4>
                            <ul class="text-sm space-y-2 text-yellow-900">
                                <li><span class="font-bold">èè³‡ (Financing)ï¼š</span>è‹¥å°ˆæ¡ˆéœ€è¦å¤–éƒ¨è³‡é‡‘ï¼Œé€™æ˜¯ç²å–è³‡æºçš„æ‰‹æ®µï¼ˆå¦‚åŸºç¤å»ºè¨­æ¡ˆï¼‰ã€‚</li>
                                <li><span class="font-bold">æ­·å²è³‡è¨Šå›é¡§ï¼š</span>æ‹¿ä»¥å‰é¡ä¼¼çš„å°ˆæ¡ˆæ•¸æ“šä¾†æª¢æŸ¥ç¾åœ¨çš„é ç®—åˆä¸åˆç†ï¼ˆé˜²å‘†æ©Ÿåˆ¶ï¼‰ã€‚</li>
                            </ul>
                        </div>
                        <div class="bg-purple-50 p-4 rounded-lg border border-purple-200">
                            <h4 class="font-bold text-purple-800 mb-2">ğŸ¢ ç®¡ç†ç’°å¢ƒå½±éŸ¿</h4>
                            <ul class="text-sm space-y-2 text-purple-900">
                                <li><span class="font-bold">çµ„ç¹”çµæ§‹ï¼š</span>
                                    <br>â€¢ å¼·çŸ©é™£/å°ˆæ¡ˆå‹ï¼šç¶“ç†æ¬ŠåŠ›å¤§ï¼Œä½ æ§é ç®—ã€‚
                                    <br>â€¢ åŠŸèƒ½å‹ï¼šåŠŸèƒ½ç¶“ç†æ¬ŠåŠ›å¤§ï¼Œä»–æ§é ç®—ã€‚
                                </li>
                                <li><span class="font-bold">æ¼¸é€²æ˜ç´°ï¼š</span>é ç®—ä¸æ˜¯ä¸€æ¬¡å®šæ­»ï¼Œæœƒéš¨è‘—å°ˆæ¡ˆé€²å±•ï¼ˆè³‡è¨Šè¶Šæ¸…æ¥šï¼‰è€Œè¶Šä¼°è¶Šæº–ã€‚</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 2. Visualizer Section -->
            <div id="view-visual" class="hidden fade-in">
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                    <div class="md:col-span-1 space-y-4">
                        <h3 class="font-bold text-lg text-gray-800">æ§åˆ¶é¢æ¿</h3>
                        <p class="text-sm text-gray-600 mb-4">èª¿æ•´ä¸‹æ–¹çš„æ»‘æ¡¿ï¼Œçœ‹çœ‹ã€ŒS æ›²ç·šã€å’Œã€Œè³‡é‡‘é™åˆ¶ã€å¦‚ä½•é‹ä½œã€‚</p>
                        
                        <div class="bg-gray-50 p-4 rounded-lg space-y-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700">å‰æœŸæ”¯å‡º (è¦åŠƒ/å•Ÿå‹•)</label>
                                <input type="range" id="early-cost" min="5" max="30" value="10" class="w-full h-2 bg-blue-200 rounded-lg appearance-none cursor-pointer">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700">ä¸­æœŸæ”¯å‡º (åŸ·è¡Œ/æ–½å·¥)</label>
                                <input type="range" id="mid-cost" min="30" max="80" value="60" class="w-full h-2 bg-blue-200 rounded-lg appearance-none cursor-pointer">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700">ç®¡ç†å„²å‚™é‡‘ (Management Reserve)</label>
                                <input type="range" id="mgmt-reserve" min="0" max="50" value="20" class="w-full h-2 bg-red-200 rounded-lg appearance-none cursor-pointer">
                                <p class="text-xs text-gray-500 mt-1">æ³¨æ„ï¼šé€™ç­†éŒ¢åœ¨æˆæœ¬åŸºæº–ä¹‹ä¸Šï¼Œå±¬æ–¼ã€ŒæœªçŸ¥çš„ä¸ç¢ºå®šæ€§ã€ã€‚</p>
                            </div>
                            
                            <div class="pt-4 border-t border-gray-200">
                                <label class="flex items-center space-x-2 cursor-pointer">
                                    <input type="checkbox" id="show-limit" class="form-checkbox h-5 w-5 text-blue-600">
                                    <span class="text-sm font-medium text-red-600">é¡¯ç¤ºè³‡é‡‘é™åˆ¶ (Funding Limit)</span>
                                </label>
                                <p class="text-xs text-gray-500 mt-1">è‹¥æ›²ç·šè¶…éç´…ç·šï¼Œä»£è¡¨ä½ éœ€è¦ã€Œèª¿ç¯€ã€è³‡é‡‘ï¼ˆé€šå¸¸èª¿æ•´æ™‚ç¨‹ï¼‰ã€‚</p>
                            </div>
                        </div>
                    </div>

                    <div class="md:col-span-2 bg-white border border-gray-200 rounded-xl p-2 shadow-inner">
                        <canvas id="sCurveChart"></canvas>
                    </div>
                </div>
            </div>

            <!-- 3. Quiz Section -->
            <div id="view-quiz" class="hidden fade-in">
                <div class="max-w-2xl mx-auto">
                    <div class="flex justify-between items-center mb-6">
                        <h3 class="text-xl font-bold">æ–°æ‰‹æŒ‘æˆ°é¡Œ</h3>
                        <span id="score-display" class="bg-blue-100 text-blue-800 px-3 py-1 rounded-full font-bold">åˆ†æ•¸: 0/0</span>
                    </div>

                    <div id="quiz-container" class="space-y-6">
                        <!-- Questions will be injected here by JS -->
                    </div>

                    <div id="quiz-result" class="hidden mt-6 p-6 bg-green-50 border border-green-200 rounded-xl text-center">
                        <h4 class="text-2xl font-bold text-green-700 mb-2">æ¸¬é©—å®Œæˆï¼</h4>
                        <p id="final-score" class="text-lg text-gray-700">ä½ çš„è§€å¿µæŒæ¡åº¦ï¼š100%</p>
                        <button onclick="resetQuiz()" class="mt-4 px-6 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition">å†æ¸¬ä¸€æ¬¡</button>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <footer class="text-center p-6 text-gray-500 text-sm">
        <p>åŸºæ–¼ NotebookLM åˆ†æå…§å®¹è£½ä½œ â€¢ å°ˆç‚º PMP åˆå­¸è€…è¨­è¨ˆ</p>
    </footer>

    <script>
        // --- 1. Tab Logic ---
        function switchTab(tabName) {
            // Update Buttons
            ['concept', 'visual', 'quiz'].forEach(t => {
                const btn = document.getElementById(`tab-${t}`);
                if (t === tabName) {
                    btn.classList.add('tab-active');
                    btn.classList.remove('hover:bg-gray-50');
                } else {
                    btn.classList.remove('tab-active');
                    btn.classList.add('hover:bg-gray-50');
                }
            });

            // Update Content
            ['view-concept', 'view-visual', 'view-quiz'].forEach(id => {
                const el = document.getElementById(id);
                if (id === `view-${tabName}`) {
                    el.classList.remove('hidden');
                    // FIX: Replaced undefined updateChart() with updateChartData()
                    if(tabName === 'visual') updateChartData(); 
                } else {
                    el.classList.add('hidden');
                }
            });
        }

        // --- 2. Chart Logic (S-Curve) ---
        let myChart = null;

        function initChart() {
            const ctx = document.getElementById('sCurveChart').getContext('2d');
            
            myChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: ['å•Ÿå‹•', 'è¦åŠƒå‰æœŸ', 'è¦åŠƒå¾ŒæœŸ', 'åŸ·è¡ŒåˆæœŸ', 'åŸ·è¡Œä¸­æœŸ', 'åŸ·è¡Œå¾ŒæœŸ', 'æ”¶å°¾'],
                    datasets: [
                        {
                            label: 'å°ˆæ¡ˆç¸½é ç®— (Budget)',
                            data: [], // calculated
                            borderColor: 'rgb(239, 68, 68)', // Red
                            borderDash: [5, 5],
                            backgroundColor: 'rgba(239, 68, 68, 0.1)',
                            fill: false,
                            tension: 0.1
                        },
                        {
                            label: 'æˆæœ¬åŸºæº– (Cost Baseline - PV)',
                            data: [], // calculated
                            borderColor: 'rgb(37, 99, 235)', // Blue
                            backgroundColor: 'rgba(37, 99, 235, 0.2)',
                            fill: true,
                            tension: 0.4
                        },
                        {
                            label: 'è³‡é‡‘é™åˆ¶ (Funding Limit)',
                            data: [], 
                            borderColor: 'rgb(220, 38, 38)',
                            borderWidth: 2,
                            pointRadius: 0,
                            hidden: true // toggled
                        }
                    ]
                },
                options: {
                    responsive: true,
                    plugins: {
                        tooltip: { mode: 'index', intersect: false },
                        title: { display: true, text: 'S æ›²ç·šèˆ‡é ç®—çµæ§‹' }
                    },
                    scales: {
                        y: { beginAtZero: true, title: { display: true, text: 'ç´¯ç©æˆæœ¬ ($)' } }
                    }
                }
            });

            updateChartData();
        }

        function updateChartData() {
            // Check if elements exist before accessing value to prevent errors during early load (though load listener handles this)
            const earlyEl = document.getElementById('early-cost');
            const midEl = document.getElementById('mid-cost');
            const mgmtEl = document.getElementById('mgmt-reserve');
            const showLimitEl = document.getElementById('show-limit');
            
            if (!earlyEl || !midEl || !mgmtEl) return;

            const early = parseInt(earlyEl.value);
            const mid = parseInt(midEl.value);
            const mgmtReserve = parseInt(mgmtEl.value);
            const showLimit = showLimitEl.checked;

            // Generate S-Curve Data Points (Cumulative)
            // Logic: Slow start, steep middle, taper off
            let cumulative = 0;
            const baselineData = [];
            
            // 7 points simulation
            const increments = [
                early * 0.5,    // å•Ÿå‹•
                early,          // è¦åŠƒå‰
                early * 1.5,    // è¦åŠƒå¾Œ
                mid * 0.8,      // åŸ·è¡Œåˆ (Ramp up)
                mid,            // åŸ·è¡Œä¸­ (Peak)
                mid * 0.6,      // åŸ·è¡Œå¾Œ (Ramp down)
                early * 0.5     // æ”¶å°¾
            ];

            increments.forEach(inc => {
                cumulative += inc;
                baselineData.push(cumulative);
            });

            const totalBaseline = baselineData[baselineData.length - 1];
            const totalBudget = totalBaseline + mgmtReserve;

            // Budget Line is usually a flat line at the top or stepped, 
            // but here we visualize it as the ceiling above the S-curve
            const budgetData = baselineData.map(() => totalBudget);

            // Funding Limit (Arbitrary limit for demo)
            const limitLine = totalBudget * 0.85; // Simulate a limit slightly below budget to show conflict
            const limitData = baselineData.map(() => limitLine);

            if (myChart) {
                myChart.data.datasets[1].data = baselineData; // Baseline
                myChart.data.datasets[0].data = budgetData;   // Total Budget
                myChart.data.datasets[2].data = limitData;    // Limit
                myChart.data.datasets[2].hidden = !showLimit;
                myChart.update();
            }
        }

        // Event Listeners for sliders
        document.getElementById('early-cost').addEventListener('input', updateChartData);
        document.getElementById('mid-cost').addEventListener('input', updateChartData);
        document.getElementById('mgmt-reserve').addEventListener('input', updateChartData);
        document.getElementById('show-limit').addEventListener('change', updateChartData);

        // --- 3. Quiz Logic ---
        const questions = [
            {
                q: "ã€Œæˆæœ¬åŸºæº–ã€é€šå¸¸æœƒä»¥ä»€éº¼æ¨£çš„å½¢å¼å±•ç¾ï¼Œç”¨ä¾†ä»£è¡¨éš¨æ™‚é–“ç´¯ç©çš„é è¨ˆæ”¯å‡ºï¼Ÿ",
                options: ["ç›´æ–¹åœ– (Histogram)", "S æ›²ç·š (S-curve)", "æ•£ä½ˆåœ– (Scatter Plot)", "æ§åˆ¶åœ– (Control Chart)"],
                a: 1,
                expl: "S æ›²ç·šé¡¯ç¤ºç´¯ç©æˆæœ¬éš¨æ™‚é–“çš„è®ŠåŒ–ï¼šåˆæœŸæ…¢ã€ä¸­æœŸå¿«ã€å¾ŒæœŸæ…¢ã€‚"
            },
            {
                q: "é—œæ–¼ã€Œæ‡‰è®Šå„²å‚™é‡‘ã€èˆ‡ã€Œç®¡ç†å„²å‚™é‡‘ã€ï¼Œä¸‹åˆ—ä½•è€…æ­£ç¢ºï¼Ÿ",
                options: [
                    "æ‡‰è®Šå„²å‚™é‡‘æ˜¯ç”¨ä¾†è™•ç†ã€ŒæœªçŸ¥çš„ä¸ç¢ºå®šæ€§ã€",
                    "ç®¡ç†å„²å‚™é‡‘åŒ…å«åœ¨ã€Œæˆæœ¬åŸºæº–ã€å…§",
                    "æ‡‰è®Šå„²å‚™é‡‘åŒ…å«åœ¨ã€Œæˆæœ¬åŸºæº–ã€å…§ï¼Œè™•ç†å·²çŸ¥é¢¨éšª",
                    "å°ˆæ¡ˆç¶“ç†å¯ä»¥éš¨æ„å‹•ç”¨ç®¡ç†å„²å‚™é‡‘"
                ],
                a: 2,
                expl: "å£è¨£ï¼šæ‡‰è®Š=å·²çŸ¥(åœ¨åŸºæº–å…§)ï¼›ç®¡ç†=æœªçŸ¥(åœ¨åŸºæº–å¤–)ã€‚"
            },
            {
                q: "ç•¶ç™¼ç¾é ç®—æ”¯å‡ºéœ€æ±‚è¶…éäº†çµ„ç¹”è¦å®šçš„è³‡é‡‘é™åˆ¶æ™‚ï¼Œå°ˆæ¡ˆç¶“ç†æ‡‰è©²é€²è¡Œä»€éº¼å‹•ä½œï¼Ÿ",
                options: [
                    "è³‡é‡‘é™åˆ¶èª¿è§£ (Funding Limit Reconciliation)",
                    "ç«‹å³åœæ­¢å°ˆæ¡ˆ",
                    "å‹•ç”¨ç®¡ç†å„²å‚™é‡‘",
                    "å¿½è¦–é™åˆ¶ç¹¼çºŒåŸ·è¡Œ"
                ],
                a: 0,
                expl: "é€™é€šå¸¸éœ€è¦èª¿æ•´æ™‚ç¨‹ä¾†å¹³æ»‘è³‡é‡‘æ”¯å‡ºï¼Œç¢ºä¿ä¸æœƒã€Œé€æ”¯ã€ã€‚"
            },
            {
                q: "åˆ¶å®šé ç®—ä¸»è¦æ˜¯å°‡ä»€éº¼æ±è¥¿é€²è¡ŒåŠ ç¸½ï¼Œä»¥å»ºç«‹æˆæœ¬åŸºæº–ï¼Ÿ",
                options: [
                    "å°ˆæ¡ˆç« ç¨‹",
                    "å€‹åˆ¥æ´»å‹•æˆ–å·¥ä½œåŒ…çš„ä¼°è¨ˆæˆæœ¬",
                    "å•†æ¥­è«–è­‰",
                    "åˆ©å®³é—œä¿‚äººæ¸…å–®"
                ],
                a: 1,
                expl: "é€™æ˜¯ã€Œç”±ä¸‹è€Œä¸Šã€çš„å½™ç¸½éç¨‹ï¼šæ´»å‹• -> å·¥ä½œåŒ… -> æ§åˆ¶å¸³æˆ¶ -> å°ˆæ¡ˆã€‚"
            }
        ];

        let currentScore = 0;
        let answeredCount = 0;

        function renderQuiz() {
            const container = document.getElementById('quiz-container');
            container.innerHTML = '';

            questions.forEach((item, index) => {
                const qEl = document.createElement('div');
                qEl.className = 'bg-white border border-gray-200 p-6 rounded-lg shadow-sm';
                qEl.innerHTML = `
                    <p class="font-bold text-lg mb-4 text-gray-800">${index + 1}. ${item.q}</p>
                    <div class="space-y-2">
                        ${item.options.map((opt, i) => `
                            <button onclick="checkAnswer(${index}, ${i}, this)" 
                                class="w-full text-left p-3 rounded border border-gray-300 hover:bg-blue-50 transition q-btn-${index}" 
                                data-idx="${i}">
                                ${opt}
                            </button>
                        `).join('')}
                    </div>
                    <div id="feedback-${index}" class="hidden mt-4 p-3 rounded text-sm font-medium"></div>
                `;
                container.appendChild(qEl);
            });
            updateScoreDisplay();
        }

        function checkAnswer(qIndex, choiceIndex, btn) {
            // Disable all buttons for this question
            const buttons = document.querySelectorAll(`.q-btn-${qIndex}`);
            buttons.forEach(b => b.disabled = true);
            answeredCount++;

            const feedback = document.getElementById(`feedback-${qIndex}`);
            feedback.classList.remove('hidden');

            const isCorrect = choiceIndex === questions[qIndex].a;
            if (isCorrect) {
                btn.classList.add('bg-green-100', 'border-green-500', 'text-green-800');
                feedback.classList.add('bg-green-100', 'text-green-800');
                feedback.innerHTML = `âœ… æ­£ç¢ºï¼ ${questions[qIndex].expl}`;
                currentScore++;
            } else {
                btn.classList.add('bg-red-100', 'border-red-500', 'text-red-800');
                feedback.classList.add('bg-red-100', 'text-red-800');
                // Highlight correct answer
                buttons[questions[qIndex].a].classList.add('bg-green-100', 'border-green-500', 'text-green-800');
                feedback.innerHTML = `âŒ éŒ¯èª¤ã€‚æ­£ç¢ºç­”æ¡ˆæ˜¯ï¼š${questions[qIndex].options[questions[qIndex].a]}ã€‚<br>${questions[qIndex].expl}`;
            }

            updateScoreDisplay();

            if (answeredCount === questions.length) {
                document.getElementById('quiz-result').classList.remove('hidden');
                document.getElementById('final-score').innerText = `ä½ çš„å¾—åˆ†ï¼š${currentScore} / ${questions.length}`;
            }
        }

        function updateScoreDisplay() {
            document.getElementById('score-display').innerText = `åˆ†æ•¸: ${currentScore}/${questions.length}`;
        }

        function resetQuiz() {
            currentScore = 0;
            answeredCount = 0;
            document.getElementById('quiz-result').classList.add('hidden');
            renderQuiz();
            window.scrollTo(0, 0);
        }

        // --- Initialization ---
        window.addEventListener('load', () => {
            initChart();
            renderQuiz();
        });

    </script>
</body>
</html>