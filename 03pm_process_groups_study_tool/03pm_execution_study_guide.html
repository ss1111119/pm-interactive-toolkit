<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>專案管理執行過程組 - 備考指南</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- React & ReactDOM -->
    <script src="https://unpkg.com/react@18/umd/react.development.js" crossorigin></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js" crossorigin></script>
    <!-- Babel -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        body { font-family: 'Segoe UI', 'Microsoft JhengHei', sans-serif; background-color: #f3f4f6; }
        .card-hover:hover { transform: translateY(-5px); transition: all 0.3s ease; }
        .animate-fade-in { animation: fadeIn 0.5s ease-in; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        // 圖標組件
        const Icon = ({ name, size = 24, className }) => {
            useEffect(() => {
                lucide.createIcons();
            }, [name]);
            return <i data-lucide={name} width={size} height={size} className={className}></i>;
        };

        // 模擬考題數據
        const quizData = [
            {
                question: "執行過程組在專案生命週期中的主要特徵是什麼？",
                options: [
                    "是制定專案章程的階段",
                    "是資源消耗最少，但規劃最詳細的階段",
                    "是資源消耗最鉅，將規劃轉化為實體成果的階段",
                    "是專案結束後進行檢討的階段"
                ],
                answer: 2,
                explanation: "來源資料明確指出，執行過程組是專案生命週期中「資源消耗最鉅、產出最直接」的時期。"
            },
            {
                question: "執行過程組最重要的一個「實體」產出是什麼？",
                options: [
                    "專案管理計畫書",
                    "可交付成果 (Deliverables)",
                    "工作績效報告",
                    "核准的變更請求"
                ],
                answer: 1,
                explanation: "執行過程組的核心目標是完成工作，其最重要的產出就是「可交付成果」。"
            },
            {
                question: "如果在執行過程中發現實際狀況與計畫有偏差，通常會產生什麼？",
                options: [
                    "專案終止",
                    "變更請求 (Change Requests)",
                    "新的專案章程",
                    "利害關係人清單"
                ],
                answer: 1,
                explanation: "當執行狀況與計畫產生偏差或發現計畫有誤時，會產出「變更請求」送交整合變更控制。"
            },
            {
                question: "關於執行過程組與其他過程組的關係，下列何者正確？",
                options: [
                    "執行過程組必須在監控過程組完全結束後才開始",
                    "執行過程組與監視和管理過程組是「同步發生」的",
                    "執行過程組不需要參考專案管理計畫書",
                    "執行過程組只涉及體力勞動，不涉及知識管理"
                ],
                answer: 1,
                explanation: "資料強調，執行過程組與「監視和管理過程組」是同時發生的，意味著動手做的同時必須不斷與基準比較。"
            },
            {
                question: "關於「管理專案知識」，下列描述何者正確？",
                options: [
                    "這是在規劃階段完成的",
                    "它只關注如何儲存檔案",
                    "利用現有知識並創造新知識，貢獻於組織學習",
                    "只有專案經理需要參與"
                ],
                answer: 2,
                explanation: "來源資料指出，執行過程也是知識管理的過程，旨在利用舊知識並創造新知識。"
            }
        ];

        // 知識點清單數據
        const checklistData = [
            {
                title: "1. 核心定義與定位",
                items: [
                    "定義：執行計畫書的工作，滿足規範",
                    "時機：計畫書完成後",
                    "同步：與「監控過程」同時發生",
                    "特徵：耗費最多資源與預算"
                ]
            },
            {
                title: "2. 核心職能 (整合)",
                items: [
                    "指導與管理專案執行：產出「可交付成果」與「績效數據」",
                    "管理專案知識：利用舊知識 + 創造新知識"
                ]
            },
            {
                title: "3. 人的管理",
                items: [
                    "資源：獲得實體資源與人員",
                    "團隊：發展能力 (Team Building) 與管理績效",
                    "溝通：資訊的收集、發布與儲存",
                    "利害關係人：管理互動與期望"
                ]
            },
            {
                title: "4. 品質、風險與採購",
                items: [
                    "品質：把政策轉化為具體活動 (QA)",
                    "風險：實施應對計畫 (Risk Response)",
                    "採購：選商、簽約 (Conduct Procurements)"
                ]
            },
            {
                title: "5. 反饋循環",
                items: [
                    "變更請求：當實際與計畫有偏差時產生",
                    "結果：可能導致計畫更新或基準重建"
                ]
            }
        ];

        // 主應用程式
        const App = () => {
            const [activeTab, setActiveTab] = useState('concept');
            const [quizScore, setQuizScore] = useState(0);
            const [showResult, setShowResult] = useState(false);
            const [answers, setAnswers] = useState({});

            const handleAnswer = (qIndex, optionIndex) => {
                setAnswers({ ...answers, [qIndex]: optionIndex });
            };

            const calculateScore = () => {
                let score = 0;
                quizData.forEach((q, index) => {
                    if (answers[index] === q.answer) score++;
                });
                setQuizScore(score);
                setShowResult(true);
            };

            const resetQuiz = () => {
                setAnswers({});
                setShowResult(false);
                setQuizScore(0);
            };

            // 導覽列
            const renderNav = () => (
                <nav className="bg-slate-800 text-white p-4 shadow-lg sticky top-0 z-50">
                    <div className="max-w-4xl mx-auto flex flex-col md:flex-row justify-between items-center gap-4">
                        <h1 className="text-xl font-bold flex items-center gap-2">
                            <Icon name="hammer" className="text-yellow-400"/> PM 執行過程備考指南
                        </h1>
                        <div className="flex bg-slate-700 rounded-lg p-1">
                            <button onClick={() => setActiveTab('concept')} className={`px-4 py-2 rounded-md transition-all ${activeTab === 'concept' ? 'bg-blue-500 text-white font-bold shadow' : 'text-gray-300 hover:text-white'}`}>核心觀念</button>
                            <button onClick={() => setActiveTab('metaphor')} className={`px-4 py-2 rounded-md transition-all ${activeTab === 'metaphor' ? 'bg-blue-500 text-white font-bold shadow' : 'text-gray-300 hover:text-white'}`}>餐廳比喻</button>
                            <button onClick={() => setActiveTab('quiz')} className={`px-4 py-2 rounded-md transition-all ${activeTab === 'quiz' ? 'bg-blue-500 text-white font-bold shadow' : 'text-gray-300 hover:text-white'}`}>模擬考題</button>
                        </div>
                    </div>
                </nav>
            );

            // 觀念頁面
            const renderConcept = () => (
                <div className="space-y-8 animate-fade-in">
                    {/* 摘要卡片 */}
                    <div className="bg-white p-6 rounded-xl shadow-lg border-l-8 border-blue-500">
                        <h2 className="text-2xl font-bold mb-4 flex items-center gap-2 text-slate-800"><Icon name="book-open" /> 定義與定位</h2>
                        <p className="text-gray-700 leading-relaxed text-lg">
                            執行過程組是專案的<span className="font-bold text-red-600 mx-1">「工廠車間」</span>。這是資源消耗最大、產出最直接的階段。
                            它的核心目標很簡單：<span className="bg-yellow-100 px-2 py-1 rounded font-medium text-slate-900">按計畫做事，產出成果。</span>
                        </p>
                    </div>

                    {/* 輸入輸出區塊 */}
                    <div className="grid md:grid-cols-2 gap-6">
                        <div className="bg-white p-6 rounded-xl shadow-md card-hover border border-slate-100">
                            <h3 className="text-xl font-bold mb-4 text-purple-600 flex items-center gap-2">
                                <Icon name="arrow-right-circle" /> 重要輸入 (Input)
                            </h3>
                            <ul className="space-y-3 text-gray-600">
                                <li className="flex items-start gap-2"><span className="text-purple-400 mt-1">●</span><span><strong>專案管理計畫書：</strong> 操作手冊與藍圖。</span></li>
                                <li className="flex items-start gap-2"><span className="text-purple-400 mt-1">●</span><span><strong>核准的變更請求：</strong> 修改後的指令。</span></li>
                                <li className="flex items-start gap-2"><span className="text-purple-400 mt-1">●</span><span><strong>組織資產：</strong> 公司的範本、過去的經驗。</span></li>
                            </ul>
                        </div>
                        <div className="bg-white p-6 rounded-xl shadow-md card-hover border border-slate-100">
                            <h3 className="text-xl font-bold mb-4 text-green-600 flex items-center gap-2">
                                <Icon name="check-circle" /> 核心產出 (Output)
                            </h3>
                            <ul className="space-y-3 text-gray-600">
                                <li className="flex items-start gap-2"><span className="text-green-400 mt-1">●</span><span className="bg-green-50 px-1 rounded"><strong>可交付成果 (Deliverables)：</strong> 最終的產品。</span></li>
                                <li className="flex items-start gap-2"><span className="text-green-400 mt-1">●</span><span><strong>工作績效數據：</strong> 原始執行紀錄。</span></li>
                                <li className="flex items-start gap-2"><span className="text-green-400 mt-1">●</span><span><strong>變更請求：</strong> 計畫不可行時提出。</span></li>
                            </ul>
                        </div>
                    </div>

                    {/* 關鍵活動領域 - 擴充版 */}
                    <div className="bg-white p-6 rounded-xl shadow-md border border-slate-100">
                        <h3 className="text-xl font-bold mb-4 text-slate-800 flex items-center gap-2">
                            <Icon name="activity" /> 關鍵活動領域
                        </h3>
                        <div className="grid md:grid-cols-3 gap-4">
                            <div className="p-4 bg-orange-50 rounded-lg border border-orange-100 hover:border-orange-300 transition-colors">
                                <h4 className="font-bold text-orange-800 mb-2 flex items-center gap-2"><Icon name="users" size={18}/> 人 (People)</h4>
                                <p className="text-sm text-gray-600 leading-relaxed">
                                    • 獲取資源<br/>
                                    • 發展團隊 (能力)<br/>
                                    • 管理團隊 (衝突)<br/>
                                    • 利害關係人管理
                                </p>
                            </div>
                            <div className="p-4 bg-blue-50 rounded-lg border border-blue-100 hover:border-blue-300 transition-colors">
                                <h4 className="font-bold text-blue-800 mb-2 flex items-center gap-2"><Icon name="shield-check" size={18}/> 管理與執行</h4>
                                <p className="text-sm text-gray-600 leading-relaxed">
                                    • 管理品質 (QA)<br/>
                                    • 實施風險回應<br/>
                                    • <span className="font-bold text-blue-600">執行採購 (選商)</span>
                                </p>
                            </div>
                            <div className="p-4 bg-gray-50 rounded-lg border border-gray-200 hover:border-gray-400 transition-colors">
                                <h4 className="font-bold text-gray-800 mb-2 flex items-center gap-2"><Icon name="brain-circuit" size={18}/> 知識整合</h4>
                                <p className="text-sm text-gray-600 leading-relaxed">
                                    • 指導與管理工作<br/>
                                    • 管理專案知識<br/>
                                    • 產生變更請求
                                </p>
                            </div>
                        </div>
                    </div>

                    {/* 知識點對照清單 */}
                    <div className="bg-slate-50 p-6 rounded-xl border border-slate-200">
                        <h3 className="text-lg font-bold text-slate-700 mb-4 flex items-center gap-2">
                            <Icon name="list-checks" /> 知識點對照清單 (Checklist)
                        </h3>
                        <div className="grid md:grid-cols-2 gap-4">
                            {checklistData.map((section, idx) => (
                                <div key={idx} className="bg-white p-4 rounded-lg shadow-sm">
                                    <h4 className="font-bold text-blue-600 mb-2 text-sm uppercase tracking-wide">{section.title}</h4>
                                    <ul className="text-sm text-gray-600 space-y-1">
                                        {section.items.map((item, i) => (
                                            <li key={i} className="flex items-start gap-2">
                                                <span className="text-green-500">✔</span>
                                                {item}
                                            </li>
                                        ))}
                                    </ul>
                                </div>
                            ))}
                        </div>
                    </div>
                </div>
            );

            // 比喻頁面
            const renderMetaphor = () => (
                <div className="space-y-6 animate-fade-in">
                    <div className="bg-yellow-50 p-6 rounded-xl border-l-8 border-yellow-500 mb-6 shadow-sm">
                        <h2 className="text-2xl font-bold mb-2 flex items-center gap-2 text-yellow-800"><Icon name="chef-hat" /> 專案就像開餐廳</h2>
                        <p className="text-yellow-900">如果你不懂專案管理術語，就想像你正在經營一家餐廳的<strong>「正式營運時段」</strong>。</p>
                    </div>

                    <div className="grid gap-4">
                        {[
                            { pm: "獲取資源", rest: "買進食材和設備", icon: "shopping-cart" },
                            { pm: "發展與管理團隊", rest: "廚師與服務生磨合默契、解決爭執", icon: "users" },
                            { pm: "管理溝通與利害關係人", rest: "服務生端菜給客人，安撫等待的顧客", icon: "message-circle" },
                            { pm: "工作績效數據", rest: "客人反應這道菜「太鹹了」", icon: "bar-chart-2" },
                            { pm: "變更請求", rest: "決定修改菜單或更換鹽巴品牌", icon: "file-edit" },
                            { pm: "實施風險回應", rest: "預備好的發電機因為停電而啟動", icon: "shield-alert" },
                            { pm: "執行採購", rest: "挑選最好的蔬菜供應商並簽約", icon: "truck" }
                        ].map((item, idx) => (
                            <div key={idx} className="flex flex-col md:flex-row items-center bg-white p-4 rounded-xl shadow-sm hover:shadow-md transition-shadow border border-slate-100">
                                <div className="flex-1 text-center md:text-right font-bold text-blue-600 text-lg px-4 md:border-r md:border-slate-100">
                                    {item.pm}
                                </div>
                                <div className="px-4 py-2 text-slate-400">
                                    <Icon name={item.icon} />
                                </div>
                                <div className="flex-1 text-center md:text-left font-medium text-slate-700 p-2 rounded">
                                    {item.rest}
                                </div>
                            </div>
                        ))}
                    </div>
                </div>
            );

            // 測驗頁面
            const renderQuiz = () => (
                <div className="max-w-2xl mx-auto animate-fade-in">
                    <div className="bg-white rounded-xl shadow-lg overflow-hidden border border-slate-200">
                        <div className="p-6 bg-slate-800 text-white text-center">
                            <h2 className="text-2xl font-bold flex justify-center items-center gap-2"><Icon name="graduation-cap" /> 考前自我檢測</h2>
                            <p className="opacity-80 mt-2">測試你對課本內容的理解程度</p>
                        </div>
                        
                        <div className="p-6 space-y-8">
                            {!showResult ? (
                                <>
                                    {quizData.map((q, qIdx) => (
                                        <div key={qIdx} className="border-b border-slate-100 pb-6 last:border-0">
                                            <h3 className="font-bold text-lg mb-4 text-slate-800">{qIdx + 1}. {q.question}</h3>
                                            <div className="space-y-3">
                                                {q.options.map((opt, oIdx) => (
                                                    <label key={oIdx} className={`block p-4 rounded-lg border cursor-pointer transition-all ${answers[qIdx] === oIdx ? 'bg-blue-50 border-blue-500 shadow-sm' : 'hover:bg-slate-50 border-slate-200'}`}>
                                                        <input 
                                                            type="radio" 
                                                            name={`q-${qIdx}`} 
                                                            className="mr-3 accent-blue-600"
                                                            onChange={() => handleAnswer(qIdx, oIdx)}
                                                            checked={answers[qIdx] === oIdx}
                                                        />
                                                        {opt}
                                                    </label>
                                                ))}
                                            </div>
                                        </div>
                                    ))}
                                    <button 
                                        onClick={calculateScore}
                                        disabled={Object.keys(answers).length < quizData.length}
                                        className="w-full bg-blue-600 text-white py-4 rounded-lg font-bold text-lg hover:bg-blue-700 disabled:bg-slate-300 disabled:cursor-not-allowed transition-colors shadow-lg shadow-blue-200"
                                    >
                                        提交答案
                                    </button>
                                </>
                            ) : (
                                <div className="text-center space-y-6">
                                    <div className="inline-block p-8 rounded-full bg-blue-50 border-4 border-blue-100">
                                        <div className="text-6xl font-bold text-blue-600">{quizScore} <span className="text-2xl text-slate-400">/ {quizData.length}</span></div>
                                    </div>
                                    <p className="text-slate-600 text-lg font-medium">
                                        {quizScore === quizData.length ? "太棒了！你已經掌握了執行過程組的精髓！" : "再接再厲，複習一下錯誤的題目吧！"}
                                    </p>
                                    
                                    <div className="text-left space-y-4 mt-8">
                                        {quizData.map((q, idx) => (
                                            <div key={idx} className={`p-5 rounded-lg border ${answers[idx] === q.answer ? 'bg-green-50 border-green-200' : 'bg-red-50 border-red-200'}`}>
                                                <div className="flex items-center gap-2 font-bold mb-2 text-slate-700">
                                                    <span className={`flex items-center justify-center w-6 h-6 rounded-full text-xs text-white ${answers[idx] === q.answer ? 'bg-green-500' : 'bg-red-500'}`}>{idx+1}</span>
                                                    {q.question}
                                                </div>
                                                <div className={`text-sm font-bold ml-8 ${answers[idx] === q.answer ? 'text-green-700' : 'text-red-700'}`}>
                                                    你的答案: {q.options[answers[idx]]}
                                                </div>
                                                {answers[idx] !== q.answer && (
                                                    <div className="text-sm text-green-700 font-bold ml-8 mt-1">
                                                        正確答案: {q.options[q.answer]}
                                                    </div>
                                                )}
                                                <div className="mt-3 ml-8 text-sm text-slate-600 bg-white/50 p-3 rounded border border-slate-100">
                                                    <span className="font-bold">解析：</span>{q.explanation}
                                                </div>
                                            </div>
                                        ))}
                                    </div>

                                    <button onClick={resetQuiz} className="px-8 py-3 border-2 border-blue-600 text-blue-600 rounded-full font-bold hover:bg-blue-50 mt-6 transition-colors">
                                        重新測驗
                                    </button>
                                </div>
                            )}
                        </div>
                    </div>
                </div>
            );

            return (
                <div className="min-h-screen pb-10 bg-slate-50">
                    {renderNav()}
                    <main className="max-w-4xl mx-auto mt-8 px-4">
                        {activeTab === 'concept' && renderConcept()}
                        {activeTab === 'metaphor' && renderMetaphor()}
                        {activeTab === 'quiz' && renderQuiz()}
                    </main>
                    <footer className="text-center text-slate-400 mt-12 py-8 border-t border-slate-200">
                        <p className="font-medium">Project Management Study Guide © 2024</p>
                        <p className="text-xs mt-2 opacity-60">Based on NotebookLM Analysis</p>
                    </footer>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>